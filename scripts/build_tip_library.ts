/**
 * 求职tip内容原子库 — 建库 + 批量写入飞书多维表格
 */
import { client } from '../src/client';

// ─── 所有 tip 数据 ───────────────────────────────────────────────
const TIPS: Array<{
  内容: string;
  分类: string;
  类型: string;
  数据来源: string;
}> = [

  // ══════════════ 心态类 ══════════════
  {
    内容: '一个人花6个月、投了1778份简历，最后收到10个面试。这不是个例，这是2025年的正常比例。很多人投了20份没动静就开始怀疑自己，其实你连样本量都还没到。',
    分类: '心态',
    类型: '真实数据',
    数据来源: '一亩三分地求职帖',
  },
  {
    内容: '求职群里只有好消息流通。别人在庆祝offer的时候，没有人发出来自己被拒了20家还没动静。你看到的成功样本是幸存者，不是平均水平。你的处境比你以为的正常得多。',
    分类: '心态',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '秋招最常见的死亡曲线：前两周积极投递，第三周开始等消息，第四周开始emo，第五周彻底躺平。大多数人输掉的不是能力，是第三周到第五周的那段心态。',
    分类: '心态',
    类型: '规律总结',
    数据来源: '原创',
  },
  {
    内容: '拿到offer那一刻回头看，你会发现那家以为绝对没戏的竟然给你发了offer，以为稳了的那家竟然石沉大海。这不是励志故事，这是招聘本来的样子，它有很大的随机性，你控制不了结果，只能控制投出去的数量。',
    分类: '心态',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '焦虑感最大的来源不是竞争激烈，是信息不对称。你以为别人都拿到了offer，但其实大家都在等。多和同一批在找工作的人交流，而不是只看朋友圈里的捷报。',
    分类: '心态',
    类型: '行动建议',
    数据来源: '原创',
  },

  // ══════════════ 简历类 ══════════════
  {
    内容: 'HR看一份简历平均只有15秒。不是因为懒，是每天几百份。所以简历的第一屏决定一切：名字下面那三行，如果没勾住人，后面写了什么都没用。',
    分类: '简历',
    类型: '真实数据',
    数据来源: '前程无忧/猫步简历数据',
  },
  {
    内容: '现在大厂简历初筛将近一半已经是AI在过。它不看你写了多少，它在对比你的词和JD里的词重合了多少。同样的经历，用岗位描述里的语言重写一遍，通过率能差一倍。',
    分类: '简历',
    类型: '真实数据',
    数据来源: '招聘行业报告2025',
  },
  {
    内容: '定制化简历的面试通过率比通用简历高47%。一份简历用到底是在浪费自己的时间。针对不同岗位花30分钟改一版，把JD里出现超过3次的词放进去，效果立竿见影。',
    分类: '简历',
    类型: '真实数据',
    数据来源: 'Indeed数据',
  },
  {
    内容: '岗位要求是愿望清单，不是门槛清单。写"5年经验优先"的岗位大量录用2年的人，写"211以上"的在招双非。要求是写给HR自我保护用的，投了才算数。',
    分类: '简历',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '简历上写"熟练使用Excel"是减分项，写"用Vlookup和数据透视表完成了XX分析，产出XX结论"才是加分项。动词+工具+结果，缺一不可。',
    分类: '简历',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '简历里的"稳定性过滤器"：频繁换实习、时间太短、方向跳动太大，都会在HR脑子里打问号。不是说不能换，是每一段要有理由，要能用一句话说清楚为什么走。',
    分类: '简历',
    类型: '内部视角',
    数据来源: '资深HR分享',
  },

  // ══════════════ 面试类 ══════════════
  {
    内容: '面试官问"你有什么缺点"，不是真的想知道你的缺点，是在看你有没有自我认知。答"我太完美主义了"是最差的回答。答一个真实但不影响这个岗位的弱点，然后说你怎么在改，才是满分。',
    分类: '面试',
    类型: '内部视角',
    数据来源: '原创',
  },
  {
    内容: '面试前查公司官网不如查脉脉和小红书。官网说的是公司想被看见的样子，脉脉说的才是真实的工作强度和氛围，搜"公司名+真实感受"，能出来的大概率是真的。',
    分类: '面试',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '反问环节问"贵公司文化怎么样"是最没用的问题。问"这个岗位上一个人为什么离开"或者"您在这家公司最看重的是什么"，才能让面试官真正记住你。',
    分类: '面试',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: 'Group面里最容易被淘汰的不是话少的那个，是话多但没有推动讨论的那个。面试官在看的是你能不能在混乱里提炼出关键问题，不是看谁嗓门大。',
    分类: '面试',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '面试感觉良好却拿不到offer，多半不是你的问题。真正录取与否的决定因素里有大量你看不见的变量：内部候选人、HC被砍、部门调整。收到拒信的时候可以复盘，但不要过度自责。',
    分类: '面试',
    类型: '反常识',
    数据来源: 'LinkedIn职场内容',
  },
  {
    内容: '72小时法则：面试结束后，合适的公司基本会在24-72小时内有动静。超过一周没消息的，基本可以认为挂了。不要干等，继续投。',
    分类: '面试',
    类型: '真实数据',
    数据来源: '招聘行业经验',
  },

  // ══════════════ 赛道类 ══════════════
  {
    内容: '想进金融但不知道从哪开始：二级市场的门比一级宽得多。只要股市开着，就需要研究员，不管你背景是什么，愿意做研究、有输出能力就有机会，比纯靠背景挤一级要现实得多。',
    分类: '赛道',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '咨询不是只有MBB。四大、精品所、产业咨询、内部战略团队，难度梯度差很多，但训练体系相近。第一份工作进哪一层没那么重要，重要的是进去之后你能做什么。',
    分类: '赛道',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '互联网商分这两年HC收缩很厉害，字节美团相对好一点，小红书B站基本没有junior位置。执着大厂商分的同学要留出plan B，新能源产业链和中型外企的商分岗位不少，竞争烈度低得多。',
    分类: '赛道',
    类型: '真实数据',
    数据来源: '招聘市场观察2025',
  },
  {
    内容: '转行咨询或金融的最大误区：以为互联网大厂经历是加分项，实际上两个圈子的用人逻辑完全不同。想跳的话，先去做1-2段对口实习建立语言体系，比直接用大厂title去投有效得多。',
    分类: '赛道',
    类型: '反常识',
    数据来源: '虎嗅转行报道',
  },
  {
    内容: '2025年程序员转行率比5年前提升42%。技术背景转商科岗位的核心优势是数据能力，最吃香的方向：数据产品、业务分析、AI相关策略岗，这三个对技术背景极度友好。',
    分类: '赛道',
    类型: '真实数据',
    数据来源: '猫步简历行业报告',
  },

  // ══════════════ 决策类 ══════════════
  {
    内容: '拿到offer之前觉得"这家公司氛围不太好"，拿到之后会开始觉得"其实还好"——这叫认知失调。选offer之前记录下你在面试时的第一直觉，那个感觉通常是最准的。',
    分类: '决策',
    类型: '心理规律',
    数据来源: '原创',
  },
  {
    内容: '直属领导是谁比公司名字重要十倍。公司好但跟了个烂领导，两年什么都没学到还留一肚子气；公司一般但领导愿意带你，三年能走出来的东西是前者的好几倍。',
    分类: '决策',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '薪资别只看base，看到手年总包：base×月数+年终奖系数+公积金基数。很多公司base高但公积金缴纳比例极低，算下来反而不如看起来low的那家。',
    分类: '决策',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '通勤时间是被严重低估的隐形成本。每天多通勤1小时，一年就是250小时，相当于31个完整工作日。这31天可以用来睡觉、学习、做任何事，把它算进去再做决定。',
    分类: '决策',
    类型: '真实数据',
    数据来源: '原创',
  },

  // ══════════════ 行动类 ══════════════
  {
    内容: '投简历最有效的渠道不是BOSS直聘，是LinkedIn冷邮件直接联系Hiring Manager。HR渠道的简历是竞争1000人的池子，冷邮件是竞争5个人的池子，差距是数量级的。',
    分类: '行动',
    类型: '反常识',
    数据来源: '一亩三分地真实案例',
  },
  {
    内容: '内推不是"认识人才能用"的特权。找到任何一个在目标公司在职的校友或前同事，直接发消息说"能帮我内推一下吗"，大部分人会帮，因为成功了他们有内推奖金。',
    分类: '行动',
    类型: '反常识',
    数据来源: '原创',
  },
  {
    内容: '最容易被忽视的求职杀手是"等待期"。很多人过了终面之后停止投递开始等结果，这是最大的浪费。offer没落地之前，继续投，继续面，手里有选择才有谈判空间。',
    分类: '行动',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '每场面试做完写一段100字的复盘：问了什么/答了什么/哪里没接住/下次怎么说。积累10场之后你会发现面试官的问题90%在重复，你的话术会越来越稳。',
    分类: '行动',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '猎头不是给有经验的人准备的，应届生也可以加。先在LinkedIn更新好简历，主动加几个做目标行业的猎头，他们不一定马上有资源，但会在有坑位的时候第一个想到你。',
    分类: '行动',
    类型: '行动建议',
    数据来源: '原创',
  },
  {
    内容: '秋招期间不要一边深度实习一边海投，两件事同时做都做不好。提前把实习收尾或者谈好灵活出勤，腾出来的时间全压在投递和准备上，比两头兼顾有效得多。',
    分类: '行动',
    类型: '规律总结',
    数据来源: '原创',
  },
];

// ─── 建表 + 写入 ────────────────────────────────────────────────
async function main() {
  console.log(`共 ${TIPS.length} 条tip，开始建库...\n`);

  // 1. 创建多维表格
  const appRes = await (client.bitable as any).app.create({
    data: { name: '求职tip内容原子库 · Lemon Talk' },
  });

  if (appRes.code !== 0) {
    console.error('❌ 创建表格失败:', appRes.msg);
    return;
  }

  const appToken = appRes.data?.app?.app_token!;
  console.log('✅ 多维表格创建成功');
  console.log(`   https://hcn2vc1r2jus.feishu.cn/base/${appToken}\n`);

  // 2. 获取默认表
  const tableListRes = await client.bitable.appTable.list({
    path: { app_token: appToken },
  });
  const tableId = tableListRes.data?.items?.[0]?.table_id!;

  // 3. 添加字段
  const fields = [
    { field_name: '分类', type: 3 },      // 3 = 单选
    { field_name: '类型', type: 3 },      // 3 = 单选
    { field_name: '数据来源', type: 1 },  // 1 = 文本
    { field_name: '使用次数', type: 2 },  // 2 = 数字
  ];

  for (const f of fields) {
    await client.bitable.appTableField.create({
      path: { app_token: appToken, table_id: tableId },
      data: f,
    });
  }
  console.log('✅ 字段创建完成（内容/分类/类型/数据来源/使用次数）\n');

  // 4. 批量写入（每批20条）
  const BATCH = 20;
  let total = 0;
  for (let i = 0; i < TIPS.length; i += BATCH) {
    const batch = TIPS.slice(i, i + BATCH);
    const res = await client.bitable.appTableRecord.batchCreate({
      path: { app_token: appToken, table_id: tableId },
      data: {
        records: batch.map(t => ({
          fields: {
            '内容': t.内容,
            '分类': t.分类,
            '类型': t.类型,
            '数据来源': t.数据来源,
            '使用次数': 0,
          },
        })),
      },
    });

    if (res.code === 0) {
      total += batch.length;
      console.log(`   写入 ${i + 1}~${Math.min(i + BATCH, TIPS.length)} 条 ✅`);
    } else {
      console.error(`   写入失败 (${i + 1}~): ${res.msg}`);
    }
  }

  console.log(`\n🎉 完成！共写入 ${total} 条tip`);
  console.log(`📋 表格地址：https://hcn2vc1r2jus.feishu.cn/base/${appToken}`);
  console.log(`   app_token: ${appToken}`);
  console.log(`   table_id:  ${tableId}`);
}

main().catch(console.error);
